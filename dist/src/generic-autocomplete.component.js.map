{"version":3,"sources":["../../src/generic-autocomplete.component.ts"],"names":[],"mappings":"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","file":"generic-autocomplete.component.js","sourceRoot":"","sourcesContent":["import { Component, Input, Output, EventEmitter } from '@angular/core';\nimport { NgbTypeaheadSelectItemEvent } from '@ng-bootstrap/ng-bootstrap';\nimport { Observable } from 'rxjs/Observable';\nimport 'rxjs/add/observable/of';\nimport 'rxjs/add/operator/catch';\nimport 'rxjs/add/operator/debounceTime';\nimport 'rxjs/add/operator/distinctUntilChanged';\nimport 'rxjs/add/operator/do';\nimport 'rxjs/add/operator/map';\nimport 'rxjs/add/operator/switchMap';\nimport 'rxjs/add/operator/merge';\n\n\nexport class GenericAutocompleteComponent {\n   itemList: any[] = [];\n   propertyName: string = '';\n   outputProperties: string[] = [];\n   outputDelimiter: string = ' ';\n\n   title: string = 'Search';\n   placeholder: string = 'Search..';\n   failedText: string = 'No items matched your search';\n   helpText: string = 'Begin typing and search suggestions will appear';  \n   fetchDataText: string = 'Click to fetch data';\n   showTitle: boolean = true;\n   showHelpText: boolean = true;\n   clearInput: boolean = true;\n   onItemSelect = new EventEmitter<any>();\n   onFetchData = new EventEmitter<boolean>();\n\n   showItems: boolean = false;\n   showTableText: boolean = true;\n   tableText: string = 'Or choose from all items..';\n   pageSize: number = 5;  \n   maxSize: number = 5;\n\n  tableActive: boolean = true;\n  page: number = 1;\n  model: any;\n  searching = false;\n  searchFailed = false;\n  hideSearchingWhenUnsubscribed = new Observable(() => () => this.searching = false);\n\n  constructor() { }\n\n  inputFormatter = (input: any) => this.clearInput ? null : input[this.propertyName];\n  resultFormatter = (input: any) => this.formatOutput(input);\n  hasItems = () => this.itemList.length > 0;\n\n  search = (query: Observable<string>) => \n    query.debounceTime(300).distinctUntilChanged()\n    .do(() => this.searching = true)\n    .switchMap(term =>\n      this.searchInternalList(term)   \n      .do((items) => {\n        this.searchFailed = false;            \n      })\n      .catch(() => {\n        this.searchFailed = true;\n        return Observable.of([]);\n      })\n    )\n    .do(() => this.searching = false)\n    .merge(this.hideSearchingWhenUnsubscribed);\n\n  searchInternalList(term: string): Observable<any> {\n    let query = term.toUpperCase();\n\n    if (term === '') {\n      return Observable.of([]);\n    }\n\n    return Observable.of(this.itemList.filter(item => {\n      let propertyValue = item[this.propertyName].toString().toUpperCase();\n      return propertyValue.substr(0, query.length) === query;\n    }));\n  } \n\n  tableSelect(item: any) {\n    this.onItemSelect.emit(item);\n  }\n\n  formatOutput(item: any) {\n    if(this.outputProperties && this.outputProperties.length > 0) {\n      let result: any[] = this.outputProperties.map(p => this.resolve(p, item));\n      return result.join(this.outputDelimiter);\n    } else {\n      return item[this.propertyName];\n    }\n  }\n\n  itemSelected(event: NgbTypeaheadSelectItemEvent) {\n    let item = event.item;    \n    this.onItemSelect.emit(item);\n  }\n  fetchData() {\n    this.onFetchData.emit(true);\n  }\n\n  private resolve(path: any, obj: any) {\n    return path === null ? '' : \n    path.split('.').reduce(function(prev: any, curr: any) {\n      return prev ? prev[curr] : null\n    }, obj);\n  }\nstatic decorators: DecoratorInvocation[] = [\n{ type: Component, args: [{\n  selector: 'generic-autocomplete',\n  template: `\n  <label for=\"typeahead\" *ngIf=\"showTitle\">{{ title }}</label>\n  <div class=\"overlay\" *ngIf=\"hasItems() !== true\" (click)=\"fetchData()\">\n      <span class=\"overlay-text\"><i class=\"fa fa-refresh\"></i> {{ fetchDataText }}</span>\n  </div>\n  <input id=\"typeahead\" [disabled]=\"hasItems() !== true\" type=\"text\" class=\"form-control\" name=\"typeahead\" aria-describedby=\"typeaheadHelp\" [class.is-invalid]=\"searchFailed\" [(ngModel)]=\"model\" [ngbTypeahead]=\"search\" [inputFormatter]=\"inputFormatter\" [resultFormatter]=\"resultFormatter\"\n      [placeholder]=\"hasItems() ? placeholder : ''\" (selectItem)=\"itemSelected($event)\" />\n  <small id=\"typeaheadHelp\" class=\"form-text text-muted\" *ngIf=\"showHelpText\">\n      {{ helpText }}\n  </small>\n  <div class=\"invalid-feedback\" *ngIf=\"searchFailed\">{{ failedText }}</div>\n  <span *ngIf=\"searching\">Searching...</span>\n  \n  <div *ngIf=\"showItems && hasItems()\">\n      <div class=\"row\">\n          <div class=\"col-6\">\n              <small class=\"form-text text-muted\" *ngIf=\"showTableText\">{{ tableText }}</small>\n          </div>\n          <div class=\"col-6 text-right\">\n              <small class=\"form-text text-muted pointer\" (click)=\"tableActive = !tableActive\">{{tableActive ? 'Hide' : 'Show'}}</small>    \n          </div>\n      </div>\n      <div class=\"row\" *ngIf=\"tableActive\">\n          <div class=\"col-6\">\n              <div class=\"input-group input-group-sm\">\n                  <div class=\"input-group-addon input-group-sm\">Items per page</div>\n                  <select class=\"form-control form-control-sm\" [(ngModel)]=\"pageSize\">\n                      <option value=\"5\">5</option>\n                      <option value=\"10\">10</option>\n                      <option value=\"25\">25</option>\n                      <option value=\"50\">50</option>\n                  </select>\n              </div>\n          </div>\n          <div class=\"col-6 d-flex\">\n              <ngb-pagination class=\"mx-auto\" [collectionSize]=\"itemList.length\" [rotate]=\"true\" [maxSize]=\"maxSize\" [pageSize]=\"pageSize\" [(page)]=\"page\" [boundaryLinks]=\"true\" size=\"sm\"></ngb-pagination>\n          </div>\n      </div>\n      <div class=\"row\" *ngIf=\"tableActive\">\n          <div class=\"col-12\">\n              <table class=\"table table-striped table-hover table-sm\">\n                  <tr class=\"pointer\" (click)=\"tableSelect(item)\" *ngFor=\"let item of itemList | slice:(page-1)*pageSize:pageSize*page\">\n                      <td>{{formatOutput(item)}}</td>\n                  </tr>\n              </table>\n          </div>\n      </div>\n  </div>\n  `,\n  styles: [`\n  .overlay {\n    text-align: center;\n    position: absolute;\n    width: calc(100% - 2rem);\n    font-size: 1rem;\n    line-height:1.25;\n    padding:0.5rem 0.75rem;\n    cursor:pointer;\n  }\n  .overlay span.overlay-text {\n    color: #505050;\n    font-weight: 700;\n  }\n  `]\n}, ] },\n];\n/** @nocollapse */\nstatic ctorParameters: () => ({type: any, decorators?: DecoratorInvocation[]}|null)[] = () => [\n];\nstatic propDecorators: {[key: string]: DecoratorInvocation[]} = {\n'itemList': [{ type: Input },],\n'propertyName': [{ type: Input },],\n'outputProperties': [{ type: Input },],\n'outputDelimiter': [{ type: Input },],\n'title': [{ type: Input },],\n'placeholder': [{ type: Input },],\n'failedText': [{ type: Input },],\n'helpText': [{ type: Input },],\n'fetchDataText': [{ type: Input },],\n'showTitle': [{ type: Input },],\n'showHelpText': [{ type: Input },],\n'clearInput': [{ type: Input },],\n'onItemSelect': [{ type: Output },],\n'onFetchData': [{ type: Output },],\n'showItems': [{ type: Input },],\n'showTableText': [{ type: Input },],\n'tableText': [{ type: Input },],\n'pageSize': [{ type: Input },],\n'maxSize': [{ type: Input },],\n};\n}\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}